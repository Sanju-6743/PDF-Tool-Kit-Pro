:root{
  --bg:#0b1220;
  --bg-accent:#101b33;
  --surface:#141f34;
  --surface-alt:#1b2a45;
  --surface-strong:#223251;
  --border:rgba(71,85,105,0.32);
  --border-strong:rgba(148,163,184,0.48);
  --text:#f8fbff;
  --text-muted:#94a3b8;
  --accent:#38bdf8;
  --accent-strong:#0ea5e9;
  --accent-soft:rgba(14,165,233,0.18);
  --accent-bg:rgba(14,165,233,0.12);
  --success:#22c55e;
  --danger:#ef4444;
  --warning:#f59e0b;
  --radius-xl:26px;
  --radius-lg:20px;
  --radius-md:14px;
  --radius-sm:10px;
  --shadow-lg:0 40px 80px rgba(8,17,33,0.45);
  --shadow-md:0 20px 40px rgba(8,17,33,0.35);
  --shadow-sm:0 10px 24px rgba(15,23,42,0.22);
  --card-outline:linear-gradient(140deg,rgba(56,189,248,0.22),rgba(14,165,233,0.06));
  --input-bg:rgba(15,23,42,0.64);
  --input-border:rgba(148,163,184,0.24);
  --scroll-thumb:rgba(56,189,248,0.4);
  color-scheme:dark;
}
[data-theme="light"]{
  --bg:#edf2ff;
  --bg-accent:#dbe4ff;
  --surface:#ffffff;
  --surface-alt:#eef2ff;
  --surface-strong:#eef1ff;
  --border:rgba(99,102,241,0.22);
  --border-strong:rgba(99,102,241,0.38);
  --text:#111827;
  --text-muted:#475569;
  --accent:#4f46e5;
  --accent-strong:#4338ca;
  --accent-soft:rgba(79,70,229,0.12);
  --accent-bg:rgba(79,70,229,0.08);
  --success:#15803d;
  --danger:#b91c1c;
  --warning:#d97706;
  --radius-xl:26px;
  --radius-lg:20px;
  --radius-md:14px;
  --radius-sm:10px;
  --shadow-lg:0 40px 80px rgba(79,70,229,0.22);
  --shadow-md:0 20px 40px rgba(79,70,229,0.18);
  --shadow-sm:0 10px 24px rgba(79,70,229,0.12);
  --card-outline:linear-gradient(140deg,rgba(79,70,229,0.28),rgba(15,23,42,0.06));
  --input-bg:rgba(255,255,255,0.85);
  --input-border:rgba(99,102,241,0.25);
  --scroll-thumb:rgba(79,70,229,0.4);
  color-scheme:light;
}
[data-theme="dark"]{
  --bg:#0b1220;
  --bg-accent:#101b33;
  --surface:#141f34;
  --surface-alt:#1b2a45;
  --surface-strong:#17253f;
  --border:rgba(71,85,105,0.32);
  --border-strong:rgba(148,163,184,0.48);
  --text:#f8fbff;
  --text-muted:#94a3b8;
  --accent:#38bdf8;
  --accent-strong:#0ea5e9;
  --accent-soft:rgba(14,165,233,0.18);
  --accent-bg:rgba(14,165,233,0.12);
  --success:#22c55e;
  --danger:#ef4444;
  --warning:#f59e0b;
  --radius-xl:26px;
  --radius-lg:20px;
  --radius-md:14px;
  --radius-sm:10px;
  --shadow-lg:0 40px 80px rgba(8,17,33,0.45);
  --shadow-md:0 20px 40px rgba(8,17,33,0.35);
  --shadow-sm:0 10px 24px rgba(8,17,33,0.28);
  --card-outline:linear-gradient(140deg,rgba(56,189,248,0.22),rgba(14,165,233,0.06));
  --input-bg:rgba(15,23,42,0.64);
  --input-border:rgba(148,163,184,0.24);
  --scroll-thumb:rgba(56,189,248,0.4);
  color-scheme:dark;
}
*{box-sizing:border-box}
html,body{
  height:100%;
  margin:0;
  font-family:"Inter","Poppins",system-ui,-apple-system,"Segoe UI",Roboto,Arial,sans-serif;
  color:var(--text);
  background:radial-gradient(circle at 20% -10%,rgba(14,165,233,0.25),transparent 40%),radial-gradient(circle at 80% 0,rgba(79,70,229,0.18),transparent 45%),linear-gradient(160deg,var(--bg) 0%,var(--bg-accent) 100%);
  transition:background .3s ease,color .3s ease;
}
body{
  min-height:100vh;
  width:100%;
  display:flex;
  justify-content:center;
  align-items:flex-start;
  padding:36px 32px;
  overflow:hidden;
}
body::before{
  content:"";
  position:fixed;
  inset:0;
  pointer-events:none;
  background:radial-gradient(ellipse at 15% 20%,rgba(56,189,248,0.12),transparent 55%),radial-gradient(ellipse at 80% 75%,rgba(79,70,229,0.12),transparent 45%);
  z-index:-1;
}
::-webkit-scrollbar{width:10px;height:10px}
::-webkit-scrollbar-track{background:transparent}
::-webkit-scrollbar-thumb{background:var(--scroll-thumb);border-radius:999px}
.app{
  width:100%;
  max-width:1440px;
  display:flex;
  flex-direction:column;
  gap:28px;
  position:relative;
  height:calc(100vh - 72px);
  padding:32px;
  border-radius:var(--radius-xl);
  border:1px solid var(--border);
  background:var(--surface);
  box-shadow:var(--shadow-lg);
}
.app::before{
  content:none;
}
.layout-body{
  display:grid;
  grid-template-columns:minmax(260px,320px) minmax(0,1fr);
  gap:28px;
  align-items:stretch;
  min-height:0;
}
.topbar{
  display:flex;
  flex-wrap:wrap;
  align-items:flex-start;
  justify-content:space-between;
  gap:24px;
  background:var(--surface-alt);
  border-radius:var(--radius-lg);
  border:1px solid var(--border);
  box-shadow:var(--shadow-md);
  padding:24px 28px;
}
.topbar-left{
  display:flex;
  flex-wrap:wrap;
  align-items:flex-start;
  gap:28px;
  flex:1 1 480px;
}
.brand{
  display:flex;
  align-items:center;
  gap:16px;
}
.logo{
  width:56px;
  height:56px;
  border-radius:16px;
  object-fit:cover;
  border:2px solid var(--border-strong);
  box-shadow:var(--shadow-sm);
}
.brand h1{
  margin:0;
  font-size:20px;
  font-weight:700;
}
.brand p{
  margin:4px 0 0 0;
  color:var(--text-muted);
  font-size:13px;
}
.topbar-metrics{
  display:flex;
  align-items:center;
  gap:20px;
}
.processing-counters,.global-counters{
  display:flex;
  align-items:center;
  gap:16px;
}
.counter{
  display:flex;
  flex-direction:column;
  gap:4px;
  padding:10px 14px;
  border-radius:var(--radius-md);
  background:var(--surface-strong);
  border:1px solid var(--border);
  min-width:110px;
}
.counter-label{
  font-size:11px;
  font-weight:600;
  letter-spacing:0.4px;
  text-transform:uppercase;
  color:var(--text-muted);
}
.counter-value{
  font-size:18px;
  font-weight:700;
  color:var(--accent);
}
.top-actions{
  display:flex;
  align-items:center;
  justify-content:flex-end;
  flex-wrap:wrap;
  gap:12px;
  row-gap:10px;
  margin-left:auto;
}
.btn{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  gap:8px;
  padding:10px 18px;
  border-radius:var(--radius-sm);
  background:var(--surface-strong);
  border:1px solid var(--border);
  color:var(--text);
  font-weight:600;
  font-size:14px;
  cursor:pointer;
  transition:all .25s ease;
  box-shadow:var(--shadow-sm);
  text-decoration:none;
}
.btn:hover{
  transform:translateY(-2px);
  border-color:var(--border-strong);
  background:linear-gradient(135deg,var(--surface-strong),var(--accent-bg));
  color:var(--text);
}
.btn.primary{
  background:linear-gradient(135deg,var(--accent),var(--accent-strong));
  color:#0b1220;
  border:1px solid transparent;
}
.btn.primary:hover{
  box-shadow:0 18px 40px rgba(14,165,233,0.3);
  color:#0b1220;
}
.btn.small{
  padding:6px 10px;
  font-size:12px;
  border-radius:8px;
}
.toggle{
  display:inline-flex;
  align-items:center;
  gap:8px;
  border-radius:999px;
  padding:8px 14px;
  background:var(--accent-soft);
  color:var(--accent);
  border:1px solid transparent;
  cursor:pointer;
}
.toggle label{font-size:12px;font-weight:600}
.sidebar{
  background:var(--surface-alt);
  border-radius:var(--radius-lg);
  border:1px solid var(--border);
  padding:26px;
  box-shadow:var(--shadow-md);
  display:flex;
  flex-direction:column;
  height:100%;
  min-height:0;
  overflow:hidden;
  position:relative;
  transition:transform .3s ease,opacity .3s ease;
}
.sidebar-tools{
  flex:1;
  min-height:0;
  overflow-y:auto;
  padding-right:8px;
  margin-right:-8px;
  overscroll-behavior:contain;
  scrollbar-width:thin;
  transition:padding .3s ease;
}
.sidebar-tools::-webkit-scrollbar{width:6px}
.sidebar-tools::-webkit-scrollbar-track{background:transparent}
.sidebar-tools::-webkit-scrollbar-thumb{
  background:var(--scroll-thumb);
  border-radius:999px;
  transition:background .3s ease;
}
.sidebar-tools::-webkit-scrollbar-thumb:hover{background:var(--accent)}
.sidebar.drawer{
  transform:translateX(-120%);
  opacity:0;
}
.sidebar.show{
  transform:translateX(0);
  opacity:1;
}
.search-container{margin-bottom:22px}
.search-input-wrapper{position:relative}
.search-icon{
  position:absolute;
  top:50%;
  left:14px;
  transform:translateY(-50%);
  color:var(--text-muted);
}
.search-input{
  width:100%;
  padding:12px 14px 12px 42px;
  border-radius:var(--radius-sm);
  border:1px solid var(--input-border);
  background:var(--input-bg);
  color:var(--text);
  font-size:14px;
  transition:border .2s ease,box-shadow .2s ease;
}
.search-input:focus{
  outline:none;
  border-color:var(--accent);
  box-shadow:0 0 0 3px var(--accent-soft);
}
.nav{
  display:flex;
  flex-direction:column;
  gap:4px;
}
.nav-group{
  margin-bottom:20px;
}
.nav-title{
  font-size:11px;
  text-transform:uppercase;
  letter-spacing:0.6px;
  color:var(--text-muted);
  margin-bottom:10px;
  font-weight:700;
}
.nav button{
  width:100%;
  display:flex;
  align-items:center;
  gap:12px;
  padding:12px 16px;
  border-radius:var(--radius-sm);
  border:1px solid transparent;
  background:transparent;
  color:var(--text-muted);
  font-size:14px;
  cursor:pointer;
  position:relative;
  max-height:48px;
  opacity:1;
  overflow:hidden;
  transition:max-height .3s ease, opacity .2s ease, padding .3s ease, transform .25s ease, background .25s ease, color .25s ease, border .25s ease;
}
.nav button:hover{
  background:var(--accent-bg);
  color:var(--text);
  transform:translateX(6px);
}
.nav button.active{
  background:linear-gradient(135deg,var(--accent),var(--accent-strong));
  color:#0b1220;
  box-shadow:var(--shadow-sm);
}
.nav button.active i{color:#0b1220}
.nav button i{font-size:15px;color:var(--accent);transition:opacity .2s ease;}
.sidebar:not(:hover):not(:focus-within) .nav button{
  max-height:0;
  padding-top:0;
  padding-bottom:0;
  opacity:0;
  margin:0;
  pointer-events:none;
}
.sidebar:not(:hover):not(:focus-within) .nav button i{
  opacity:0;
}
.sidebar:not(:hover):not(:focus-within) .nav button.active{
  background:transparent;
  color:var(--text-muted);
  box-shadow:none;
}
.sidebar:hover .sidebar-tools,
.sidebar:focus-within .sidebar-tools{
  padding-right:12px;
}
.sidebar-tools:focus{outline:none;}
hr{border:none;border-top:1px solid var(--border);margin:18px 0}
.content{
  background:var(--surface-alt);
  border-radius:var(--radius-lg);
  border:1px solid var(--border);
  box-shadow:var(--shadow-md);
  padding:28px;
  overflow:hidden;
  min-height:0;
  position:relative;
  display:flex;
  flex-direction:column;
  gap:24px;
}
.content::-webkit-scrollbar{width:8px}
.tool{display:none;min-height:100%}
.tool.active{display:block}
.viewer{display:flex;flex-direction:column;gap:20px;min-height:0}
.controls{
  display:flex;
  flex-wrap:wrap;
  gap:12px;
  align-items:center;
}
.page-info{
  display:flex;
  align-items:center;
  gap:6px;
  background:var(--surface-strong);
  border-radius:var(--radius-sm);
  padding:6px 10px;
  border:1px solid var(--border);
}
.page-info input{
  width:70px;
  padding:6px 8px;
  background:transparent;
  border:0;
  color:var(--text);
  font-weight:600;
}
.page-info input:focus{outline:none}
.zoom-controls{
  display:flex;
  align-items:center;
  gap:8px;
  background:var(--surface-strong);
  border-radius:var(--radius-sm);
  border:1px solid var(--border);
  padding:8px 10px;
}
.zoom-controls select{
  background:var(--surface);
  color:var(--text);
  border:1px solid var(--border);
  border-radius:var(--radius-sm);
  padding:6px 10px;
}
.zoom-controls input[type="range"]{width:160px}
.canvas-wrap{
  display:grid;
  grid-template-columns:minmax(0,1fr) 220px;
  gap:18px;
  align-items:flex-start;
}
.dropzone{
  position:relative;
  border:1px dashed var(--border-strong);
  border-radius:var(--radius-lg);
  padding:42px 32px;
  text-align:center;
  background:var(--surface-strong);
  color:var(--text-muted);
  transition:all .25s ease;
  cursor:pointer;
  min-height:170px;
  display:flex;
  flex-direction:column;
  justify-content:center;
  gap:12px;
}
.dropzone:hover{
  border-color:var(--accent);
  color:var(--text);
  background:var(--accent-bg);
}
.dropzone.drag-over{
  border-color:var(--accent-strong);
  box-shadow:0 0 0 4px var(--accent-soft);
  transform:translateY(-2px) scale(1.01);
}
.dropzone.uploading{
  border-color:var(--accent);
  background:linear-gradient(135deg,var(--surface-strong),var(--accent-bg));
}
.dropzone.success{
  border-color:var(--success);
  background:rgba(34,197,94,0.12);
}
.drag-area{
  border-radius:var(--radius-md);
  border:1px dashed var(--border);
  background:var(--surface-strong);
  padding:20px;
  text-align:center;
  color:var(--text-muted);
}
.grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(180px,1fr));
  gap:18px;
}
canvas#pdf-canvas{
  width:100%;
  height:auto;
  border-radius:var(--radius-md);
  background:var(--surface);
  border:1px solid var(--border);
  box-shadow:var(--shadow-sm);
}
.thumbs{
  display:flex;
  flex-direction:column;
  gap:12px;
  max-height:540px;
  overflow-y:auto;
}
.thumbs canvas{
  width:100%;
  border-radius:var(--radius-sm);
  border:1px solid var(--border);
  background:var(--surface);
}
textarea{
  width:100%;
  min-height:200px;
  border-radius:var(--radius-md);
  border:1px solid var(--input-border);
  background:var(--input-bg);
  color:var(--text);
  padding:14px;
  font-family:inherit;
  resize:vertical;
}
textarea::placeholder{color:var(--text-muted)}
input,select{
  font-family:inherit;
  color:var(--text);
}
input[type="number"],input[type="text"],select{
  border-radius:var(--radius-sm);
  border:1px solid var(--input-border);
  background:var(--input-bg);
  padding:10px 12px;
}
input[type="number"]:focus,input[type="text"]:focus,select:focus{
  outline:none;
  border-color:var(--accent);
  box-shadow:0 0 0 3px var(--accent-soft);
}
.file-preview-container{margin-top:20px;display:flex;flex-direction:column;gap:12px}
.file-card{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:16px;
  padding:14px 18px;
  border-radius:var(--radius-md);
  background:var(--surface-alt);
  border:1px solid var(--border);
  box-shadow:var(--shadow-sm);
  animation:fade-up .35s ease;
}
@keyframes fade-up{from{opacity:0;transform:translateY(12px)}to{opacity:1;transform:translateY(0)}}
.file-icon{
  width:44px;
  height:44px;
  border-radius:14px;
  display:flex;
  align-items:center;
  justify-content:center;
  background:var(--accent-bg);
  color:var(--accent);
  font-size:18px;
}
.file-info{flex:1;min-width:0}
.file-name{font-weight:600;color:var(--text);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
.file-size{font-size:12px;color:var(--text-muted)}
.file-status{font-size:12px;font-weight:600;color:var(--accent)}
.file-status.success{color:var(--success)}
.file-status.error{color:var(--danger)}
.file-actions{display:flex;gap:8px}
.file-action-btn{
  width:32px;
  height:32px;
  border-radius:10px;
  border:1px solid transparent;
  background:var(--surface-strong);
  color:var(--text-muted);
  cursor:pointer;
  transition:all .2s ease;
}
.file-action-btn:hover{background:var(--accent-bg);color:var(--accent)}
.upload-progress-container{margin-top:14px;display:flex;flex-direction:column;gap:8px}
.upload-progress{width:100%;height:6px;background:var(--surface-strong);border-radius:999px;overflow:hidden}
.upload-progress-bar{height:100%;background:linear-gradient(90deg,var(--accent),var(--accent-strong));transition:width .3s ease}
.upload-progress-text{display:flex;align-items:center;justify-content:space-between;color:var(--text-muted);font-size:12px}
.success-animation,.error-animation{display:none}
.badge{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  min-width:20px;
  height:20px;
  border-radius:999px;
  background:var(--danger);
  color:#fff;
  font-weight:700;
  font-size:11px;
}
.popup{
  position:fixed;
  top:24px;
  right:24px;
  background:var(--surface);
  border-radius:var(--radius-md);
  border:1px solid var(--border);
  box-shadow:var(--shadow-md);
  padding:16px;
  width:320px;
  display:none;
  color:var(--text);
}
.popup.show{display:block}
.popup.error{border-left:4px solid var(--danger)}
.popup.success{border-left:4px solid var(--success)}
.popup.info{border-left:4px solid var(--accent)}
.popup-content{display:flex;flex-direction:column;gap:12px}
#popupClose{
  align-self:flex-end;
  padding:6px 12px;
  border-radius:var(--radius-sm);
  border:1px solid var(--border);
  background:var(--surface-alt);
  color:var(--text);
  cursor:pointer;
}
.overlay{
  position:fixed;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  background:rgba(15,23,42,0.72);
  backdrop-filter:blur(10px);
  opacity:0;
  visibility:hidden;
  transition:all .25s ease;
  z-index:9999;
}
.overlay.show{opacity:1;visibility:visible}
.loader{
  width:160px;
  height:160px;
  border-radius:var(--radius-lg);
  background:var(--surface);
  border:1px solid var(--border);
  box-shadow:var(--shadow-md);
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  gap:12px;
  padding:20px;
}
.spinner{
  width:52px;
  height:52px;
  border-radius:50%;
  border:6px solid rgba(148,163,184,0.22);
  border-top-color:var(--accent);
  animation:spin 1s linear infinite;
}
@keyframes spin{to{transform:rotate(360deg)}}
.login-screen{
  position:fixed;
  inset:0;
  background:linear-gradient(160deg,rgba(14,165,233,0.85),rgba(15,23,42,0.95));
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:10001;
}
.login-container{
  background:var(--surface);
  border-radius:var(--radius-lg);
  border:1px solid var(--border);
  padding:38px;
  width:100%;
  max-width:420px;
  box-shadow:var(--shadow-lg);
  text-align:center;
}
.login-header img{width:68px;height:68px;border-radius:18px;border:2px solid var(--accent)}
.login-header h2{margin:18px 0 6px 0;font-size:24px}
.login-header p{margin:0;color:var(--text-muted)}
.tab-buttons{
  display:flex;
  border-radius:999px;
  background:var(--surface-strong);
  padding:4px;
  margin-bottom:20px;
}
.tab-btn{
  flex:1;
  border-radius:999px;
  border:0;
  background:transparent;
  color:var(--text-muted);
  padding:10px 0;
  font-weight:600;
  cursor:pointer;
  transition:all .2s ease;
}
.tab-btn.active{
  background:linear-gradient(135deg,var(--accent),var(--accent-strong));
  color:#0b1220;
  box-shadow:var(--shadow-sm);
}
.form-content{display:none}
.form-content.active{display:block}
.form-content input{
  width:100%;
  margin-bottom:14px;
  padding:12px 14px;
  border-radius:var(--radius-sm);
  border:1px solid var(--input-border);
  background:var(--input-bg);
}
.form-content button{width:100%;margin-top:8px}
.auth-message{margin-top:16px;font-size:13px}
.auth-message.success{color:var(--success)}
.auth-message.error{color:var(--danger)}
.full-width{width:100%}
.muted{color:var(--text-muted);font-size:13px}
.small{font-size:12px}
@media(max-width:1280px){
  .app{grid-template-columns:240px 1fr;padding:28px}
  .canvas-wrap{grid-template-columns:minmax(0,1fr)}
}
@media(max-width:1024px){
  body{padding:24px}
  .app{grid-template-columns:1fr;grid-template-rows:auto auto 1fr;padding:28px}
  .sidebar{height:auto;max-height:none}
  .content{height:auto;max-height:none}
}
@media(max-width:768px){
  .topbar{flex-direction:column;align-items:flex-start}
  .topbar-left{flex-direction:column;align-items:flex-start;width:100%}
  .processing-counters,.global-counters{flex-wrap:wrap}
  .top-actions{width:100%;flex-wrap:wrap}
  .sidebar{display:none}
  .sidebar.show{display:block;position:fixed;top:24px;left:24px;right:24px;bottom:24px;height:auto;z-index:1000}
  .content{padding:20px}
}
@media(max-width:540px){
  .app{padding:20px}
  .btn{width:100%;justify-content:center}
  .controls{flex-direction:column;align-items:stretch}
  .zoom-controls{width:100%;justify-content:space-between}
  .brand{gap:12px}
  .brand h1{font-size:18px}
}

/* KPI Flash Animation for Real-time Updates */
.kpi-flash{
  animation:kpi-flash-pulse 2s ease;
}
@keyframes kpi-flash-pulse {
  0%, 100% {
    transform: scale(1);
    box-shadow: 0 0 0 0 rgba(56, 189, 248, 0.7);
  }
  25% {
    transform: scale(1.05);
    box-shadow: 0 0 0 6px rgba(56, 189, 248, 0);
  }
  50% {
    transform: scale(1.03);
    box-shadow: 0 0 0 0 rgba(56, 189, 248, 0.4);
  }
  75% {
    transform: scale(1.01);
    box-shadow: 0 0 0 3px rgba(56, 189, 248, 0);
  }
}
